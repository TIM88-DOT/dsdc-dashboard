{"ast":null,"code":"import _classCallCheck from \"D:/pcs/dsdc-dashboard/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"D:/pcs/dsdc-dashboard/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"D:/pcs/dsdc-dashboard/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"D:/pcs/dsdc-dashboard/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport EventEmitter from \"eventemitter3\";\nimport { XMLHttpRequest } from \"xhr2-cookies\";\nimport { getFromWindow } from \"@walletconnect/utils\";\nvar XHR = getFromWindow(\"XMLHttpRequest\") || XMLHttpRequest;\nvar HTTPConnection = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(HTTPConnection, _EventEmitter);\n  var _super = _createSuper(HTTPConnection);\n  function HTTPConnection(url) {\n    var _this;\n    _classCallCheck(this, HTTPConnection);\n    _this = _super.call(this);\n    _this.url = url;\n    return _this;\n  }\n  _createClass(HTTPConnection, [{\n    key: \"formatError\",\n    value: function formatError(payload, message) {\n      var code = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : -1;\n      return {\n        error: {\n          message: message,\n          code: code\n        },\n        id: payload.id,\n        jsonrpc: payload.jsonrpc\n      };\n    }\n  }, {\n    key: \"send\",\n    value: function send(payload, internal) {\n      var _this2 = this;\n      return new Promise(function (resolve) {\n        if (payload.method === \"eth_subscribe\") {\n          var error = _this2.formatError(payload, \"Subscriptions are not supported by this HTTP endpoint\");\n          _this2.emit(\"error\", error);\n          return resolve(error);\n        }\n        var xhr = new XHR();\n        var responded = false;\n        var res = function res(err, result) {\n          if (!responded) {\n            xhr.abort();\n            responded = true;\n            if (internal) {\n              internal(err, result);\n            } else {\n              var id = payload.id,\n                jsonrpc = payload.jsonrpc;\n              var response = err ? {\n                id: id,\n                jsonrpc: jsonrpc,\n                error: {\n                  message: err.message,\n                  code: err.code\n                }\n              } : {\n                id: id,\n                jsonrpc: jsonrpc,\n                result: result\n              };\n              _this2.emit(\"payload\", response);\n              resolve(response);\n            }\n          }\n        };\n        xhr.open(\"POST\", _this2.url, true);\n        xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n        xhr.timeout = 60 * 1000;\n        xhr.onerror = res;\n        xhr.ontimeout = res;\n        xhr.onreadystatechange = function () {\n          if (xhr.readyState === 4) {\n            try {\n              var response = JSON.parse(xhr.responseText);\n              res(response.error, response.result);\n            } catch (e) {\n              res(e);\n            }\n          }\n        };\n        xhr.send(JSON.stringify(payload));\n      });\n    }\n  }]);\n  return HTTPConnection;\n}(EventEmitter);\nexport default HTTPConnection;","map":{"version":3,"sources":["../../src/index.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import EventEmitter from \"eventemitter3\";\nimport { XMLHttpRequest } from \"xhr2-cookies\";\nimport { getFromWindow } from \"@walletconnect/utils\";\nconst XHR = getFromWindow(\"XMLHttpRequest\") || XMLHttpRequest;\nclass HTTPConnection extends EventEmitter {\n    constructor(url) {\n        super();\n        this.url = url;\n    }\n    formatError(payload, message, code = -1) {\n        return {\n            error: { message, code },\n            id: payload.id,\n            jsonrpc: payload.jsonrpc,\n        };\n    }\n    send(payload, internal) {\n        return new Promise(resolve => {\n            if (payload.method === \"eth_subscribe\") {\n                const error = this.formatError(payload, \"Subscriptions are not supported by this HTTP endpoint\");\n                this.emit(\"error\", error);\n                return resolve(error);\n            }\n            const xhr = new XHR();\n            let responded = false;\n            const res = (err, result) => {\n                if (!responded) {\n                    xhr.abort();\n                    responded = true;\n                    if (internal) {\n                        internal(err, result);\n                    }\n                    else {\n                        const { id, jsonrpc } = payload;\n                        const response = err\n                            ? { id, jsonrpc, error: { message: err.message, code: err.code } }\n                            : { id, jsonrpc, result };\n                        this.emit(\"payload\", response);\n                        resolve(response);\n                    }\n                }\n            };\n            xhr.open(\"POST\", this.url, true);\n            xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n            xhr.timeout = 60 * 1000;\n            xhr.onerror = res;\n            xhr.ontimeout = res;\n            xhr.onreadystatechange = () => {\n                if (xhr.readyState === 4) {\n                    try {\n                        const response = JSON.parse(xhr.responseText);\n                        res(response.error, response.result);\n                    }\n                    catch (e) {\n                        res(e);\n                    }\n                }\n            };\n            xhr.send(JSON.stringify(payload));\n        });\n    }\n}\nexport default HTTPConnection;\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"module"}