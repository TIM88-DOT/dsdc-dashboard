{"ast":null,"code":"import _regeneratorRuntime from\"D:/pcs/dsdc-dashboard/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/pcs/dsdc-dashboard/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/pcs/dsdc-dashboard/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import{ethers}from\"ethers\";import{addresses,abis}from\"@uniswap-v2-app/contracts\";import{useEthers}from\"@usedapp/core\";import axios from\"axios\";var useGetStakedNFTs=function useGetStakedNFTs(plan){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),ids=_useState2[0],setIds=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),tokensOfOwner=_useState4[0],setTokensOfOwner=_useState4[1];var _useEthers=useEthers(),account=_useEthers.account;useEffect(function(){var fetchIds=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var provider,contract,_ids;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;provider=new ethers.providers.JsonRpcProvider(\"https://bsc-dataseed.binance.org\");contract=new ethers.Contract(addresses.staking,abis.staking,provider);_context.next=5;return contract.getStakedTokens(plan,account);case 5:_ids=_context.sent;setIds(_ids);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 12:case\"end\":return _context.stop();}},_callee,null,[[0,9]]);}));return function fetchIds(){return _ref.apply(this,arguments);};}();function getNftsData(_x){return _getNftsData.apply(this,arguments);}function _getNftsData(){_getNftsData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(userNfts){var tokenData,j,dsdcMetaData,nftTokenData;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:tokenData=[];j=0;case 2:if(!(j<(userNfts===null||userNfts===void 0?void 0:userNfts.length))){_context2.next=11;break;}_context2.next=5;return axios.get(\"https://bafybeigmbv6qevyposswcncodvket6bl34chc4j6326akxg2xj6arkmfwu.ipfs.nftstorage.link/\".concat(userNfts[j],\".json\"));case 5:dsdcMetaData=_context2.sent;nftTokenData={img:\"https://drunkskunksdc.mypinata.cloud/ipfs/\".concat(dsdcMetaData.data.image.slice(7)),title:dsdcMetaData.data.name,tokenId:userNfts[j]};tokenData.push(nftTokenData);case 8:j++;_context2.next=2;break;case 11:return _context2.abrupt(\"return\",tokenData);case 12:case\"end\":return _context2.stop();}},_callee2);}));return _getNftsData.apply(this,arguments);}function getData(){return _getData.apply(this,arguments);}function _getData(){_getData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var tokenData;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return getNftsData(ids.map(function(e){return e.toString();}));case 2:tokenData=_context3.sent;setTokensOfOwner(tokenData);case 4:case\"end\":return _context3.stop();}},_callee3);}));return _getData.apply(this,arguments);}fetchIds();getData();},[account,plan,ids]);return tokensOfOwner;};export default useGetStakedNFTs;","map":{"version":3,"names":["useState","useEffect","ethers","addresses","abis","useEthers","axios","useGetStakedNFTs","plan","_useState","_useState2","_slicedToArray","ids","setIds","_useState3","_useState4","tokensOfOwner","setTokensOfOwner","_useEthers","account","fetchIds","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","provider","contract","_ids","wrap","_callee$","_context","prev","next","providers","JsonRpcProvider","Contract","staking","getStakedTokens","sent","t0","console","error","stop","apply","arguments","getNftsData","_x","_getNftsData","_callee2","userNfts","tokenData","j","dsdcMetaData","nftTokenData","_callee2$","_context2","length","get","concat","img","data","image","slice","title","name","tokenId","push","abrupt","getData","_getData","_callee3","_callee3$","_context3","map","e","toString"],"sources":["D:/pcs/dsdc-dashboard/packages/react-app/src/hooks/useGetStakedNFTs.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport { addresses, abis } from \"@uniswap-v2-app/contracts\";\r\nimport { useEthers } from \"@usedapp/core\";\r\nimport axios from \"axios\";\r\n\r\nconst useGetStakedNFTs = (plan) => {\r\n  const [ids, setIds] = useState([]);\r\n  const [tokensOfOwner, setTokensOfOwner] = useState([]);\r\n  const { account } = useEthers();\r\n  useEffect(() => {\r\n    const fetchIds = async () => {\r\n      try {\r\n        const provider = new ethers.providers.JsonRpcProvider(\r\n          \"https://bsc-dataseed.binance.org\"\r\n        );\r\n        const contract = new ethers.Contract(\r\n          addresses.staking,\r\n          abis.staking,\r\n          provider\r\n        );\r\n        const ids = await contract.getStakedTokens(plan, account);\r\n        setIds(ids);\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    };\r\n    async function getNftsData(userNfts) {\r\n      const tokenData = [];\r\n      for (var j = 0; j < userNfts?.length; j++) {\r\n        const dsdcMetaData = await axios.get(\r\n          `https://bafybeigmbv6qevyposswcncodvket6bl34chc4j6326akxg2xj6arkmfwu.ipfs.nftstorage.link/${userNfts[j]}.json`\r\n        );\r\n        const nftTokenData = {\r\n          img: `https://drunkskunksdc.mypinata.cloud/ipfs/${dsdcMetaData.data.image.slice(\r\n            7\r\n          )}`,\r\n          title: dsdcMetaData.data.name,\r\n          tokenId: userNfts[j],\r\n        };\r\n        tokenData.push(nftTokenData);\r\n      }\r\n\r\n      return tokenData;\r\n    }\r\n    async function getData() {\r\n      const tokenData = await getNftsData(ids.map((e) => e.toString()));\r\n      setTokensOfOwner(tokenData);\r\n    }\r\n    fetchIds();\r\n    getData();\r\n  }, [account, plan, ids]);\r\n\r\n  return tokensOfOwner;\r\n};\r\n\r\nexport default useGetStakedNFTs;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}